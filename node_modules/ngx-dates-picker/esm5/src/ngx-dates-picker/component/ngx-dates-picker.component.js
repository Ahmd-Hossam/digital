import { __assign, __decorate } from "tslib";
import { Component, Input, HostListener, forwardRef, ViewChild } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { startOfMonth, endOfMonth, addMonths, subMonths, setYear, eachDayOfInterval, getDate, getMonth, getYear, isToday, isSameMonth, format, getDay, subDays, setDay, isAfter, isBefore, addDays, setMonth, } from 'date-fns';
import { isSameDate, createDateRange } from '../helpers';
// Counter for calculating the auto-incrementing field ID
var counter = 0;
/**
 * Internal library helper that helps to check if value is empty
 * @param value
 */
var isNil = function (value) {
    return (typeof value === 'undefined') || (value === null);
};
var ɵ0 = isNil;
var NgxDatesPickerComponent = /** @class */ (function () {
    function NgxDatesPickerComponent() {
        var _this = this;
        /**
         * Disable datepicker's input
         */
        this.headless = false;
        /**
         * Set datepicker's visibility state
         */
        this.isOpened = false;
        /**
         * Datepicker dropdown position
         */
        this.position = 'bottom-right';
        this.currentOptions = {
            closeOnClickOutside: true,
            closeOnSelection: true,
            includeDays: 'previous-month',
            includeNextMonthsFirstFullWeek: false,
            minYear: 1970,
            maxYear: 2030,
            displayFormat: 'MMM dd, yyyy',
            barTitleFormat: 'MMMM yyyy',
            dayNamesFormat: 'EEE',
            rangeSeparator: '-',
            selectRange: false,
            firstCalendarDay: 0,
            barTitleIfEmpty: 'Click to select a date',
            locale: {},
            placeholder: '',
            addClass: {},
            addStyle: {},
            fieldId: this.defaultFieldId,
            useEmptyBarTitle: true,
        };
        this.onTouchedCallback = function () { };
        this.onChangeCallback = function () { };
        this.formatDay = function (date, isVisible) {
            if (isVisible === void 0) { isVisible = true; }
            return ({
                date: date,
                day: getDate(date),
                month: getMonth(date),
                year: getYear(date),
                inThisMonth: isSameMonth(date, _this.viewingDate),
                isToday: isVisible && isToday(date),
                isSelected: isVisible && _this.isDateSelected(date),
                isInRange: isVisible && _this.isInRange(date),
                isSelectable: isVisible && _this.isDateSelectable(date),
                isStart: isVisible && _this.isRangeBoundary(date, 'start'),
                isEnd: isVisible && _this.isRangeBoundary(date, 'end'),
                isVisible: isVisible,
            });
        };
        this.scrollOptions = {
            barBackground: '#DFE3E9',
            gridBackground: '#FFFFFF',
            barBorderRadius: '3',
            gridBorderRadius: '3',
            barWidth: '6',
            gridWidth: '6',
            barMargin: '0',
            gridMargin: '0'
        };
    }
    NgxDatesPickerComponent_1 = NgxDatesPickerComponent;
    NgxDatesPickerComponent.prototype.setDisabledState = function (isDisabled) {
        this.disabled = isDisabled;
    };
    Object.defineProperty(NgxDatesPickerComponent.prototype, "range", {
        get: function () {
            return this._range;
        },
        set: function (val) {
            this._range = val;
            this.onChangeCallback(this.getValueToEmit(val));
        },
        enumerable: true,
        configurable: true
    });
    NgxDatesPickerComponent.prototype.ngOnInit = function () {
        this.view = 'days';
        this.range = {
            start: new Date(),
            end: new Date(),
        };
        this.viewingDate = new Date();
        this.initDayNames();
        this.initYears();
        this.initMonths();
    };
    NgxDatesPickerComponent.prototype.ngOnChanges = function (changes) {
        if ('options' in changes) {
            this.updateOptions(changes.options.currentValue);
            this.initDayNames();
            this.init();
            this.initYears();
            this.initMonths();
        }
    };
    Object.defineProperty(NgxDatesPickerComponent.prototype, "defaultFieldId", {
        get: function () {
            // Only evaluate and increment if required
            var value = "datepicker-" + counter++;
            Object.defineProperty(this, 'defaultFieldId', { value: value });
            return value;
        },
        enumerable: true,
        configurable: true
    });
    NgxDatesPickerComponent.prototype.updateOptions = function (options) {
        this.currentOptions = __assign(__assign({}, this.currentOptions), options);
    };
    NgxDatesPickerComponent.prototype.nextMonth = function () {
        this.viewingDate = addMonths(this.viewingDate, 1);
        this.init();
    };
    NgxDatesPickerComponent.prototype.prevMonth = function () {
        this.viewingDate = subMonths(this.viewingDate, 1);
        this.init();
    };
    NgxDatesPickerComponent.prototype.setDate = function (i) {
        var date = this.days[i].date;
        if (this.currentOptions.selectRange) {
            if (!this.range.start && !this.range.end) {
                this.range.start = date;
            }
            else if (this.range.start && !this.range.end && isAfter(date, this.range.start)) {
                this.range.end = date;
            }
            else {
                this.range.end = undefined;
                this.range.start = date;
            }
        }
        else {
            this.range.start = this.range.end = date;
        }
        this.init();
        this.onChangeCallback(this.getValueToEmit(this.range));
        if (this.currentOptions.closeOnSelection && this.range.end) {
            this.close();
        }
    };
    NgxDatesPickerComponent.prototype.setYear = function (i) {
        this.viewingDate = setYear(this.viewingDate, this.years[i].year);
        this.init();
        this.initYears();
        this.view = 'months';
    };
    NgxDatesPickerComponent.prototype.setMonth = function (i) {
        this.viewingDate = setMonth(this.viewingDate, this.months[i].month);
        this.init();
        this.initMonths();
        this.view = 'days';
    };
    NgxDatesPickerComponent.prototype.init = function () {
        var _this = this;
        if (!this.viewingDate) {
            return;
        }
        var start = startOfMonth(this.viewingDate);
        var end = endOfMonth(this.viewingDate);
        this.days = eachDayOfInterval({ start: start, end: end }).map(function (date) { return _this.formatDay(date); });
        var firstMonthDay = getDay(start) - this.currentOptions.firstCalendarDay;
        var prevDays = firstMonthDay < 0 ? 7 - this.currentOptions.firstCalendarDay : firstMonthDay;
        var nextDays = (this.currentOptions.firstCalendarDay === 1 ? 7 : 6) - getDay(end);
        var showPrevMonthDays = this.currentOptions.includeDays === 'all' || this.currentOptions.includeDays === 'previous-month';
        var showNextMonthDays = this.currentOptions.includeDays === 'all' || this.currentOptions.includeDays === 'next-month';
        if (showNextMonthDays && this.currentOptions.includeNextMonthsFirstFullWeek) {
            nextDays += 7;
        }
        for (var i = 1; i <= prevDays; i++) {
            this.days.unshift(this.formatDay(subDays(start, i), showPrevMonthDays));
        }
        new Array(nextDays).fill(undefined)
            .forEach(function (_, i) { return _this.days.push(_this.formatDay(addDays(end, i + 1), showNextMonthDays)); });
        this.displayValue = this.formatDisplay();
        if (this.range) {
            this.barTitle = format(this.viewingDate, this.currentOptions.barTitleFormat, this.currentOptions.locale);
        }
        else {
            this.barTitle = this.currentOptions.useEmptyBarTitle ?
                this.currentOptions.barTitleIfEmpty :
                format(this.viewingDate, this.currentOptions.barTitleFormat, this.currentOptions.locale);
        }
    };
    NgxDatesPickerComponent.prototype.initYears = function () {
        var _this = this;
        var range = this.currentOptions.maxYear - this.currentOptions.minYear;
        this.years = Array.from(new Array(range), function (x, i) { return i + _this.currentOptions.minYear; }).map(function (year) {
            return { year: year, isThisYear: year === getYear(_this.viewingDate) };
        });
    };
    NgxDatesPickerComponent.prototype.initMonths = function () {
        var _this = this;
        this.months = Array.from(new Array(12), function (x, i) { return setMonth(new Date(), i + 1); })
            .map(function (date) {
            return { month: date.getMonth(), name: format(date, 'MMM'), isSelected: date.getMonth() === getMonth(_this.viewingDate) };
        });
    };
    NgxDatesPickerComponent.prototype.initDayNames = function () {
        this.dayNames = [];
        var start = this.currentOptions.firstCalendarDay;
        for (var i = start; i <= 6 + start; i++) {
            var date = setDay(new Date(), i);
            this.dayNames.push(format(date, this.currentOptions.dayNamesFormat, this.currentOptions.locale));
        }
    };
    NgxDatesPickerComponent.prototype.toggleView = function () {
        this.view = this.view === 'days' ? 'years' : 'days';
    };
    NgxDatesPickerComponent.prototype.toggle = function () {
        this.isOpened = !this.isOpened;
        if (!this.isOpened && this.view === 'years') {
            this.toggleView();
        }
    };
    NgxDatesPickerComponent.prototype.close = function () {
        this.isOpened = false;
        if (this.view === 'years') {
            this.toggleView();
        }
    };
    NgxDatesPickerComponent.prototype.reset = function () {
        this.range = {
            start: new Date(),
            end: new Date(),
        };
        this.init();
    };
    NgxDatesPickerComponent.prototype.writeValue = function (val) {
        if (val) {
            if (typeof val === 'string') {
                this.range.start = this.range.end = new Date(val);
            }
            else if (val instanceof Date) {
                this.range.start = this.range.end = val;
            }
            else if (val.start) { // Checking if it's instance of DateRange
                this.range = val;
            }
            else {
                throw Error('Invalid input data type');
            }
            this.viewingDate = this.range.start || this.viewingDate;
            this.init();
        }
    };
    NgxDatesPickerComponent.prototype.registerOnChange = function (fn) {
        this.onChangeCallback = fn;
    };
    NgxDatesPickerComponent.prototype.registerOnTouched = function (fn) {
        this.onTouchedCallback = fn;
    };
    NgxDatesPickerComponent.prototype.onBlur = function (e) {
        if (!this.isOpened || !this.currentOptions.closeOnClickOutside) {
            return;
        }
        if (this.inputElement == null) {
            return;
        }
        if (e.target === this.inputElement.nativeElement ||
            this.inputElement.nativeElement.contains(e.target) ||
            (e.target.parentElement && e.target.parentElement.classList.contains('day-unit'))) {
            return;
        }
        if (this.calendarContainerElement.nativeElement !== e.target &&
            !this.calendarContainerElement.nativeElement.contains(e.target) &&
            !e.target.classList.contains('year-unit') &&
            !e.target.classList.contains('month-unit')) {
            this.close();
        }
    };
    NgxDatesPickerComponent.prototype.getDayClasses = function (day) {
        return {
            'is-prev-month': !day.inThisMonth,
            'is-today': day.isToday,
            'is-selected': day.isSelected,
            'is-in-range': day.isInRange,
            'is-disabled': !day.isSelectable,
            'range-start': day.isStart,
            'range-end': day.isEnd,
            'is-visible': day.isVisible,
        };
    };
    /**
     * Checks if specified date is in range of min and max dates
     * @param date
     */
    NgxDatesPickerComponent.prototype.isDateSelectable = function (date) {
        var minDateSet = !isNil(this.currentOptions.minDate);
        var maxDateSet = !isNil(this.currentOptions.maxDate);
        var timestamp = date.valueOf();
        return (!(minDateSet && timestamp < this.currentOptions.minDate.valueOf()) ||
            (!(maxDateSet && timestamp > this.currentOptions.maxDate.valueOf())));
    };
    NgxDatesPickerComponent.prototype.isDateSelected = function (date) {
        return isSameDate(date, this.range.start) || isSameDate(date, this.range.end);
    };
    NgxDatesPickerComponent.prototype.isInRange = function (date) {
        return this.isDateSelected(date) || (isAfter(date, this.range.start) && isBefore(date, this.range.end));
    };
    NgxDatesPickerComponent.prototype.formatDisplay = function () {
        if (!this.range) {
            return '';
        }
        var formattedStartDate = format(this.range.start, this.currentOptions.displayFormat, this.currentOptions.locale);
        if (this.currentOptions.selectRange) {
            var formattedEndDate = format(this.range.end || this.range.start, this.currentOptions.displayFormat, this.currentOptions.locale);
            return "" + formattedStartDate + this.currentOptions.rangeSeparator + formattedEndDate;
        }
        return formattedStartDate;
    };
    NgxDatesPickerComponent.prototype.isRangeBoundary = function (date, boundary) {
        return !this.range[boundary] || isSameDate(date, this.range[boundary]);
    };
    NgxDatesPickerComponent.prototype.getValueToEmit = function (range) {
        if (!this.currentOptions.selectRange) {
            return new Date(range.start.getTime());
        }
        if (range.end) {
            return createDateRange(range.start, range.end);
        }
        return createDateRange(range.start, range.start);
    };
    var NgxDatesPickerComponent_1;
    __decorate([
        ViewChild('container')
    ], NgxDatesPickerComponent.prototype, "calendarContainerElement", void 0);
    __decorate([
        ViewChild('inputElement')
    ], NgxDatesPickerComponent.prototype, "inputElement", void 0);
    __decorate([
        Input()
    ], NgxDatesPickerComponent.prototype, "options", void 0);
    __decorate([
        Input()
    ], NgxDatesPickerComponent.prototype, "headless", void 0);
    __decorate([
        Input()
    ], NgxDatesPickerComponent.prototype, "isOpened", void 0);
    __decorate([
        Input()
    ], NgxDatesPickerComponent.prototype, "position", void 0);
    __decorate([
        Input()
    ], NgxDatesPickerComponent.prototype, "previousMonthButtonTemplate", void 0);
    __decorate([
        Input()
    ], NgxDatesPickerComponent.prototype, "nextMonthButtonTemplate", void 0);
    __decorate([
        HostListener('document:click', ['$event'])
    ], NgxDatesPickerComponent.prototype, "onBlur", null);
    NgxDatesPickerComponent = NgxDatesPickerComponent_1 = __decorate([
        Component({
            selector: 'ngx-dates-picker',
            template: "<div class=\"ngx-dates-picker-container\">\n  <input *ngIf=\"!headless\"\n         #inputElement\n         type=\"text\"\n         class=\"ngx-dates-picker-input\"\n         [(ngModel)]=\"displayValue\"\n         readonly\n         [placeholder]=\"currentOptions.placeholder\"\n         [ngClass]=\"currentOptions.addClass\"\n         [ngStyle]=\"currentOptions.addStyle\"\n         [id]=\"fieldId\"\n         [disabled]=\"disabled\"\n         (click)=\"toggle()\" />\n  <ng-content></ng-content>\n  <div class=\"ngx-dates-picker-calendar-container ngx-dates-picker-position-{{position}}\"\n       *ngIf=\"isOpened\"\n       #container>\n    <div class=\"topbar-container\">\n      <div (click)=\"prevMonth()\">\n        <ng-template [ngTemplateOutlet]=\"previousMonthButtonTemplate || defaultPreviousMonthTemplate\"></ng-template>\n      </div>\n      <ng-template #defaultPreviousMonthTemplate>\n        <svg width=\"7px\"\n             height=\"10px\"\n             viewBox=\"0 0 7 10\"\n             version=\"1.1\"\n             xmlns=\"http://www.w3.org/2000/svg\"\n             xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n          <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n            <g transform=\"translate(-923.000000, -1882.000000)\" fill=\"#CED0DA\">\n              <g transform=\"translate(80.000000, 1361.000000)\">\n                <g transform=\"translate(0.000000, 430.000000)\">\n                  <g transform=\"translate(825.000000, 0.000000)\">\n                    <g transform=\"translate(0.000000, 72.000000)\">\n                      <g transform=\"translate(18.000000, 15.000000)\">\n                        <polygon id=\"Back\" points=\"6.015 4 0 9.013 6.015 14.025\"></polygon>\n                      </g>\n                    </g>\n                  </g>\n                </g>\n              </g>\n            </g>\n          </g>\n        </svg>\n      </ng-template>\n      <span class=\"topbar-title\" (click)=\"toggleView()\">{{ barTitle }}</span>\n      <div (click)=\"nextMonth()\">\n        <ng-template [ngTemplateOutlet]=\"nextMonthButtonTemplate || defaultNextMonthTemplate\"></ng-template>\n      </div>\n      <ng-template #defaultNextMonthTemplate>\n        <svg width=\"7px\"\n             height=\"10px\"\n             viewBox=\"0 0 6 10\"\n             version=\"1.1\"\n             xmlns=\"http://www.w3.org/2000/svg\"\n             xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n          <g id=\"Source-Sans---UI-Elements-Kit\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n            <g id=\"White-Layout\" transform=\"translate(-1182.000000, -1882.000000)\" fill=\"#CED0DA\">\n              <g id=\"Dropdowns-&amp;-Selector\" transform=\"translate(80.000000, 1361.000000)\">\n                <g id=\"Dropdowns\" transform=\"translate(0.000000, 430.000000)\">\n                  <g id=\"Calendar\" transform=\"translate(825.000000, 0.000000)\">\n                    <g transform=\"translate(0.000000, 72.000000)\" id=\"Top-Bar-Nav\">\n                      <g transform=\"translate(18.000000, 15.000000)\">\n                        <polygon id=\"Forward\"\n                                 transform=\"translate(262.007500, 9.012500) scale(-1, 1) translate(-262.007500, -9.012500) \"\n                                 points=\"265.015 4 259 9.013 265.015 14.025\">\n                        </polygon>\n                      </g>\n                    </g>\n                  </g>\n                </g>\n              </g>\n            </g>\n          </g>\n        </svg>\n      </ng-template>\n    </div>\n    <div class=\"main-calendar-container\">\n      <ng-container *ngIf=\"view === 'days'\">\n        <div class=\"main-calendar-day-names\">\n          <span class=\"day-name-unit\" *ngFor=\"let name of dayNames\">{{ name }}</span>\n        </div>\n        <div class=\"main-calendar-days\">\n          <span class=\"day-unit\"\n                *ngFor=\"let day of days; let i = index;\"\n                (click)=\"day.isSelectable && setDate(i)\">\n            <span class=\"day-background-upper\"\n                  [ngClass]=\"this.getDayClasses(day)\">{{ day.isVisible ? day.day : '' }}</span>\n            <span class=\"day-background-lower\"\n                  [ngClass]=\"this.getDayClasses(day)\"></span>\n          </span>\n        </div>\n      </ng-container>\n      <div *ngIf=\"view === 'years'\">\n        <div class=\"main-calendar-years\" slimScroll [options]=\"scrollOptions\">\n          <span *ngFor=\"let year of years; let i = index;\"\n                class=\"year-unit\"\n                [ngClass]=\"{ 'is-selected': year.isThisYear }\"\n                (click)=\"setYear(i)\"\n          >\n            {{ year.year }}\n          </span>\n        </div>\n        </div>\n      <div *ngIf=\"view === 'months'\" class=\"main-calendar-months\">\n        <span *ngFor=\"let month of months; let i = index;\"\n              class=\"month-unit\"\n              [ngClass]=\"{ 'is-selected': month.isSelected}\"\n              (click)=\"setMonth(i)\"\n        >\n          {{ month.name }}\n        </span>\n      </div>\n    </div>\n  </div>\n</div>\n",
            providers: [
                { provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(function () { return NgxDatesPickerComponent_1; }), multi: true }
            ],
            styles: [".ngx-dates-picker-position-bottom-left{top:40px;right:0}.ngx-dates-picker-position-bottom-right{top:40px;left:0}.ngx-dates-picker-position-top-left{bottom:40px;right:0}.ngx-dates-picker-position-top-right{bottom:40px;left:0}.ngx-dates-picker-position-static{position:static!important}.ngx-dates-picker-container{position:relative}.ngx-dates-picker-input{padding:5px 10px;font-size:14px;width:200px;outline:0;border:1px solid #dfe3e9}.ngx-dates-picker-calendar-container{position:absolute;width:300px;background:#fff;box-shadow:0 1px 4px 0 rgba(0,0,0,.08);border:1px solid #dfe3e9;border-radius:4px}.topbar-container{width:100%;height:50px;padding:0 15px;border-bottom:1px solid #dfe3e9;display:flex;justify-content:space-between;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.topbar-container svg{cursor:pointer}.topbar-container svg g{fill:#ced0da}.topbar-container div{cursor:pointer}.topbar-title{color:#3d495c;font-size:14px;font-weight:600;cursor:pointer}.main-calendar-container{width:100%;height:100%;padding:15px 10px 0;font-size:12px;font-weight:500}.main-calendar-day-names{color:#cbcbcb;width:100%;display:flex;align-items:center}.day-name-unit{width:calc(100% / 7);text-transform:uppercase;text-align:center}.main-calendar-days,.main-calendar-years{padding:15px 0 0;width:100%;display:inline-block;overflow:hidden}.day-unit,.month-unit,.year-unit{position:relative;width:calc(100% / 7);font-size:14px;font-weight:400;height:40px;display:inline-flex;float:left;align-items:center;justify-content:center;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.day-background-upper{display:inline-flex;position:absolute;z-index:1;width:100%;height:100%;border-radius:50%;align-items:center;justify-content:center}.day-background-upper.is-selected{background:#0186ff;color:#fff}.day-background-upper:not(.is-visible){cursor:default}.day-background-upper.is-visible:hover{background:#f0f0f0;color:#000}.day-background-upper.is-visible.is-prev-month{color:#cbcbcb}.day-background-upper.is-visible.is-disabled{cursor:not-allowed;color:#cbcbcb}.day-background-lower{display:inline-flex;position:absolute;z-index:0;width:100%;height:100%;align-items:center;justify-content:center;border-top:2px solid #fff;border-bottom:2px solid #fff}.day-background-lower.is-in-range{background:rgba(1,134,255,.1)}.day-background-lower.range-start{border-bottom-left-radius:50%;border-top-left-radius:50%}.day-background-lower.range-end{border-bottom-right-radius:50%;border-top-right-radius:50%}.main-calendar-years{height:210px;display:block;padding:0}.month-unit{width:calc(100% / 4);height:54px}.year-unit{width:calc(100% / 3)}.month-unit,.year-unit{border-radius:10px}.month-unit.is-selected,.year-unit.is-selected{background:#0186ff;color:#fff}.month-unit:hover,.year-unit:hover{background:#f0f0f0;color:#000}.main-calendar-months{padding-bottom:10px;display:inline-block}"]
        })
    ], NgxDatesPickerComponent);
    return NgxDatesPickerComponent;
}());
export { NgxDatesPickerComponent };
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWRhdGVzLXBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtZGF0ZXMtcGlja2VyLyIsInNvdXJjZXMiOlsic3JjL25neC1kYXRlcy1waWNrZXIvY29tcG9uZW50L25neC1kYXRlcy1waWNrZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUVULEtBQUssRUFJTCxZQUFZLEVBQ1osVUFBVSxFQUNWLFNBQVMsRUFFVixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsaUJBQWlCLEVBQXdCLE1BQU0sZ0JBQWdCLENBQUM7QUFDekUsT0FBTyxFQUNMLFlBQVksRUFDWixVQUFVLEVBQ1YsU0FBUyxFQUNULFNBQVMsRUFDVCxPQUFPLEVBQ1AsaUJBQWlCLEVBQ2pCLE9BQU8sRUFDUCxRQUFRLEVBQ1IsT0FBTyxFQUNQLE9BQU8sRUFDUCxXQUFXLEVBQ1gsTUFBTSxFQUNOLE1BQU0sRUFDTixPQUFPLEVBQ1AsTUFBTSxFQUNOLE9BQU8sRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLFFBQVEsR0FDckMsTUFBTSxVQUFVLENBQUM7QUFFbEIsT0FBTyxFQUFFLFVBQVUsRUFBRSxlQUFlLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFvQ3pELHlEQUF5RDtBQUN6RCxJQUFJLE9BQU8sR0FBRyxDQUFDLENBQUM7QUFFaEI7OztHQUdHO0FBQ0gsSUFBTSxLQUFLLEdBQUcsVUFBQyxLQUErQjtJQUM1QyxPQUFPLENBQUMsT0FBTyxLQUFLLEtBQUssV0FBVyxDQUFDLElBQUksQ0FBQyxLQUFLLEtBQUssSUFBSSxDQUFDLENBQUM7QUFDNUQsQ0FBQyxDQUFDOztBQVVGO0lBNkVFO1FBQUEsaUJBV0M7UUFsRkQ7O1dBRUc7UUFDTSxhQUFRLEdBQUcsS0FBSyxDQUFDO1FBRTFCOztXQUVHO1FBQ00sYUFBUSxHQUFHLEtBQUssQ0FBQztRQUUxQjs7V0FFRztRQUNNLGFBQVEsR0FBbUIsY0FB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QztZQUNULFFBQVEsRUFBRSxrQkFBa0I7WUFDNUIsaWxLQUE4QztZQUU5QyxTQUFTLEVBQUU7Z0JBQ1QsRUFBRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsV0FBVyxFQUFFLFVBQVUsQ0FBQyxjQUFNLE9BQUEseUJBQXVCLEVBQXZCLENBQXVCLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFO2FBQ3BHOztTQUNGLENBQUM7T0FDVyx1QkFBdUIsQ0F3Wm5DO0lBQUQsOEJBQUM7Q0FBQSxBQXhaRCxJQXdaQztTQXhaWSx1QkFBdUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIE9uSW5pdCxcbiAgSW5wdXQsXG4gIE9uQ2hhbmdlcyxcbiAgU2ltcGxlQ2hhbmdlcyxcbiAgRWxlbWVudFJlZixcbiAgSG9zdExpc3RlbmVyLFxuICBmb3J3YXJkUmVmLFxuICBWaWV3Q2hpbGQsXG4gIFRlbXBsYXRlUmVmXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTkdfVkFMVUVfQUNDRVNTT1IsIENvbnRyb2xWYWx1ZUFjY2Vzc29yIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHtcbiAgc3RhcnRPZk1vbnRoLFxuICBlbmRPZk1vbnRoLFxuICBhZGRNb250aHMsXG4gIHN1Yk1vbnRocyxcbiAgc2V0WWVhcixcbiAgZWFjaERheU9mSW50ZXJ2YWwsXG4gIGdldERhdGUsXG4gIGdldE1vbnRoLFxuICBnZXRZZWFyLFxuICBpc1RvZGF5LFxuICBpc1NhbWVNb250aCxcbiAgZm9ybWF0LFxuICBnZXREYXksXG4gIHN1YkRheXMsXG4gIHNldERheSxcbiAgaXNBZnRlciwgaXNCZWZvcmUsIGFkZERheXMsIHNldE1vbnRoLFxufSBmcm9tICdkYXRlLWZucyc7XG5pbXBvcnQgeyBJU2xpbVNjcm9sbE9wdGlvbnMgfSBmcm9tICduZ3gtc2xpbXNjcm9sbCc7XG5pbXBvcnQgeyBpc1NhbWVEYXRlLCBjcmVhdGVEYXRlUmFuZ2UgfSBmcm9tICcuLi9oZWxwZXJzJztcbmltcG9ydCB7IERhdGVSYW5nZSwgRGF5IH0gZnJvbSAnLi4vbW9kZWxzJztcblxuZXhwb3J0IHR5cGUgQWRkQ2xhc3MgPSBzdHJpbmcgfCBzdHJpbmdbXSB8IHsgW2s6IHN0cmluZ106IGJvb2xlYW4gfSB8IG51bGw7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGF0ZXBpY2tlck9wdGlvbnMge1xuICBjbG9zZU9uQ2xpY2tPdXRzaWRlPzogYm9vbGVhbjtcbiAgY2xvc2VPblNlbGVjdGlvbj86IGJvb2xlYW47XG4gIGluY2x1ZGVEYXlzPzogJ25vbmUnIHwgJ3ByZXZpb3VzLW1vbnRoJyB8ICduZXh0LW1vbnRoJyB8ICdhbGwnO1xuICBpbmNsdWRlTmV4dE1vbnRoc0ZpcnN0RnVsbFdlZWs/OiBib29sZWFuO1xuICBtaW5ZZWFyPzogbnVtYmVyOyAvLyBkZWZhdWx0OiBjdXJyZW50IHllYXIgLSAzMFxuICBtYXhZZWFyPzogbnVtYmVyOyAvLyBkZWZhdWx0OiBjdXJyZW50IHllYXIgKyAzMFxuICBkaXNwbGF5Rm9ybWF0Pzogc3RyaW5nOyAvLyBkZWZhdWx0OiAnTU1NIERbLF0gWVlZWSdcbiAgYmFyVGl0bGVGb3JtYXQ/OiBzdHJpbmc7IC8vIGRlZmF1bHQ6ICdNTU1NIFlZWVknXG4gIGRheU5hbWVzRm9ybWF0Pzogc3RyaW5nOyAvLyBkZWZhdWx0ICdkZGQnXG4gIGJhclRpdGxlSWZFbXB0eT86IHN0cmluZztcbiAgc2VsZWN0UmFuZ2U/OiBib29sZWFuO1xuICByYW5nZVNlcGFyYXRvcj86IHN0cmluZzsgLy8gZGVmYXVsdCAnLSdcbiAgZmlyc3RDYWxlbmRhckRheT86IG51bWJlcjsgLy8gMCA9IFN1bmRheSAoZGVmYXVsdCksIDEgPSBNb25kYXksIC4uXG4gIGxvY2FsZT86IG9iamVjdDtcbiAgbWluRGF0ZT86IERhdGU7XG4gIG1heERhdGU/OiBEYXRlO1xuICAvKiogUGxhY2Vob2xkZXIgZm9yIHRoZSBpbnB1dCBmaWVsZCAqL1xuICBwbGFjZWhvbGRlcj86IHN0cmluZztcbiAgLyoqIFtuZ0NsYXNzXSB0byBhZGQgdG8gdGhlIGlucHV0IGZpZWxkICovXG4gIGFkZENsYXNzPzogQWRkQ2xhc3M7XG4gIC8qKiBbbmdTdHlsZV0gdG8gYWRkIHRvIHRoZSBpbnB1dCBmaWVsZCAqL1xuICBhZGRTdHlsZT86IHsgW2s6IHN0cmluZ106IGFueSB9IHwgbnVsbDtcbiAgLyoqIElEIHRvIGFzc2lnbiB0byB0aGUgaW5wdXQgZmllbGQgKi9cbiAgZmllbGRJZD86IHN0cmluZztcbiAgLyoqIElmIGZhbHNlLCBiYXJUaXRsZUlmRW1wdHkgd2lsbCBiZSBkaXNyZWdhcmRlZCBhbmQgYSBkYXRlIHdpbGwgYWx3YXlzIGJlIHNob3duLiBEZWZhdWx0OiB0cnVlICovXG4gIHVzZUVtcHR5QmFyVGl0bGU/OiBib29sZWFuO1xufVxuXG5leHBvcnQgdHlwZSBQaWNrZXJQb3NpdGlvbiA9ICdib3R0b20tbGVmdCcgfCAnYm90dG9tLXJpZ2h0JyB8ICd0b3AtbGVmdCcgfCAndG9wLXJpZ2h0JyB8ICdzdGF0aWMnO1xuXG4vLyBDb3VudGVyIGZvciBjYWxjdWxhdGluZyB0aGUgYXV0by1pbmNyZW1lbnRpbmcgZmllbGQgSURcbmxldCBjb3VudGVyID0gMDtcblxuLyoqXG4gKiBJbnRlcm5hbCBsaWJyYXJ5IGhlbHBlciB0aGF0IGhlbHBzIHRvIGNoZWNrIGlmIHZhbHVlIGlzIGVtcHR5XG4gKiBAcGFyYW0gdmFsdWVcbiAqL1xuY29uc3QgaXNOaWwgPSAodmFsdWU6IERhdGUgfCBEYXRlcGlja2VyT3B0aW9ucykgPT4ge1xuICByZXR1cm4gKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcpIHx8ICh2YWx1ZSA9PT0gbnVsbCk7XG59O1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICduZ3gtZGF0ZXMtcGlja2VyJyxcbiAgdGVtcGxhdGVVcmw6ICduZ3gtZGF0ZXMtcGlja2VyLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJ25neC1kYXRlcy1waWNrZXIuY29tcG9uZW50LnNhc3MnXSxcbiAgcHJvdmlkZXJzOiBbXG4gICAgeyBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUiwgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTmd4RGF0ZXNQaWNrZXJDb21wb25lbnQpLCBtdWx0aTogdHJ1ZSB9XG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgTmd4RGF0ZXNQaWNrZXJDb21wb25lbnQgaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciwgT25Jbml0LCBPbkNoYW5nZXMge1xuICBAVmlld0NoaWxkKCdjb250YWluZXInKSBjYWxlbmRhckNvbnRhaW5lckVsZW1lbnQ6IEVsZW1lbnRSZWY7XG4gIEBWaWV3Q2hpbGQoJ2lucHV0RWxlbWVudCcpIGlucHV0RWxlbWVudDogRWxlbWVudFJlZjtcblxuICBASW5wdXQoKSBvcHRpb25zOiBEYXRlcGlja2VyT3B0aW9ucztcblxuICAvKipcbiAgICogRGlzYWJsZSBkYXRlcGlja2VyJ3MgaW5wdXRcbiAgICovXG4gIEBJbnB1dCgpIGhlYWRsZXNzID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIFNldCBkYXRlcGlja2VyJ3MgdmlzaWJpbGl0eSBzdGF0ZVxuICAgKi9cbiAgQElucHV0KCkgaXNPcGVuZWQgPSBmYWxzZTtcblxuICAvKipcbiAgICogRGF0ZXBpY2tlciBkcm9wZG93biBwb3NpdGlvblxuICAgKi9cbiAgQElucHV0KCkgcG9zaXRpb246IFBpY2tlclBvc2l0aW9uID0gJ2JvdHRvbS1yaWdodCc7XG5cbiAgQElucHV0KCkgcHJldmlvdXNNb250aEJ1dHRvblRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBASW5wdXQoKSBuZXh0TW9udGhCdXR0b25UZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcblxuICBjdXJyZW50T3B0aW9uczogRGF0ZXBpY2tlck9wdGlvbnMgPSB7XG4gICAgY2xvc2VPbkNsaWNrT3V0c2lkZTogdHJ1ZSxcbiAgICBjbG9zZU9uU2VsZWN0aW9uOiB0cnVlLFxuICAgIGluY2x1ZGVEYXlzOiAncHJldmlvdXMtbW9udGgnLFxuICAgIGluY2x1ZGVOZXh0TW9udGhzRmlyc3RGdWxsV2VlazogZmFsc2UsXG4gICAgbWluWWVhcjogMTk3MCxcbiAgICBtYXhZZWFyOiAyMDMwLFxuICAgIGRpc3BsYXlGb3JtYXQ6ICdNTU0gZGQsIHl5eXknLFxuICAgIGJhclRpdGxlRm9ybWF0OiAnTU1NTSB5eXl5JyxcbiAgICBkYXlOYW1lc0Zvcm1hdDogJ0VFRScsXG4gICAgcmFuZ2VTZXBhcmF0b3I6ICctJyxcbiAgICBzZWxlY3RSYW5nZTogZmFsc2UsXG4gICAgZmlyc3RDYWxlbmRhckRheTogMCxcbiAgICBiYXJUaXRsZUlmRW1wdHk6ICdDbGljayB0byBzZWxlY3QgYSBkYXRlJyxcbiAgICBsb2NhbGU6IHt9LFxuICAgIHBsYWNlaG9sZGVyOiAnJyxcbiAgICBhZGRDbGFzczoge30sXG4gICAgYWRkU3R5bGU6IHt9LFxuICAgIGZpZWxkSWQ6IHRoaXMuZGVmYXVsdEZpZWxkSWQsXG4gICAgdXNlRW1wdHlCYXJUaXRsZTogdHJ1ZSxcbiAgfTtcblxuICBkaXNwbGF5VmFsdWU6IHN0cmluZztcbiAgdmlld2luZ0RhdGU6IERhdGU7XG4gIGJhclRpdGxlOiBzdHJpbmc7XG4gIHZpZXc6ICdkYXlzJyB8ICdtb250aHMnIHwgJ3llYXJzJztcbiAgeWVhcnM6IHsgeWVhcjogbnVtYmVyOyBpc1RoaXNZZWFyOiBib29sZWFuIH1bXTtcbiAgbW9udGhzOiB7IG1vbnRoOiBudW1iZXI7IG5hbWU6IHN0cmluZzsgaXNTZWxlY3RlZDogYm9vbGVhbiB9W107XG4gIGRheU5hbWVzOiBzdHJpbmdbXTtcbiAgc2Nyb2xsT3B0aW9uczogSVNsaW1TY3JvbGxPcHRpb25zO1xuICBkYXlzOiBEYXlbXTtcbiAgZmllbGRJZDogc3RyaW5nO1xuICBkaXNhYmxlZDogYm9vbGVhbjtcblxuICBwcml2YXRlIF9yYW5nZTogRGF0ZVJhbmdlO1xuXG4gIHByaXZhdGUgb25Ub3VjaGVkQ2FsbGJhY2s6ICgpID0+IHZvaWQgPSAoKSA9PiB7IH07XG4gIHByaXZhdGUgb25DaGFuZ2VDYWxsYmFjazogKF86IGFueSkgPT4gdm9pZCA9ICgpID0+IHsgfTtcblxuICBwdWJsaWMgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkOiBib29sZWFuKSB7XG4gICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XG4gIH1cblxuICBzZXQgcmFuZ2UodmFsOiBEYXRlUmFuZ2UgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl9yYW5nZSA9IHZhbDtcblxuICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayh0aGlzLmdldFZhbHVlVG9FbWl0KHZhbCkpO1xuICB9XG5cbiAgZ2V0IHJhbmdlKCk6IERhdGVSYW5nZSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX3JhbmdlO1xuICB9XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zY3JvbGxPcHRpb25zID0ge1xuICAgICAgYmFyQmFja2dyb3VuZDogJyNERkUzRTknLFxuICAgICAgZ3JpZEJhY2tncm91bmQ6ICcjRkZGRkZGJyxcbiAgICAgIGJhckJvcmRlclJhZGl1czogJzMnLFxuICAgICAgZ3JpZEJvcmRlclJhZGl1czogJzMnLFxuICAgICAgYmFyV2lkdGg6ICc2JyxcbiAgICAgIGdyaWRXaWR0aDogJzYnLFxuICAgICAgYmFyTWFyZ2luOiAnMCcsXG4gICAgICBncmlkTWFyZ2luOiAnMCdcbiAgICB9O1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy52aWV3ID0gJ2RheXMnO1xuICAgIHRoaXMucmFuZ2UgPSB7XG4gICAgICBzdGFydDogbmV3IERhdGUoKSxcbiAgICAgIGVuZDogbmV3IERhdGUoKSxcbiAgICB9O1xuICAgIHRoaXMudmlld2luZ0RhdGUgPSBuZXcgRGF0ZSgpO1xuXG4gICAgdGhpcy5pbml0RGF5TmFtZXMoKTtcbiAgICB0aGlzLmluaXRZZWFycygpO1xuICAgIHRoaXMuaW5pdE1vbnRocygpO1xuICB9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIGlmICgnb3B0aW9ucycgaW4gY2hhbmdlcykge1xuICAgICAgdGhpcy51cGRhdGVPcHRpb25zKGNoYW5nZXMub3B0aW9ucy5jdXJyZW50VmFsdWUpO1xuICAgICAgdGhpcy5pbml0RGF5TmFtZXMoKTtcbiAgICAgIHRoaXMuaW5pdCgpO1xuICAgICAgdGhpcy5pbml0WWVhcnMoKTtcbiAgICAgIHRoaXMuaW5pdE1vbnRocygpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBkZWZhdWx0RmllbGRJZCgpOiBzdHJpbmcge1xuICAgIC8vIE9ubHkgZXZhbHVhdGUgYW5kIGluY3JlbWVudCBpZiByZXF1aXJlZFxuICAgIGNvbnN0IHZhbHVlID0gYGRhdGVwaWNrZXItJHtjb3VudGVyKyt9YDtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgJ2RlZmF1bHRGaWVsZElkJywge3ZhbHVlfSk7XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICB1cGRhdGVPcHRpb25zKG9wdGlvbnM6IERhdGVwaWNrZXJPcHRpb25zKTogdm9pZCB7XG4gICAgdGhpcy5jdXJyZW50T3B0aW9ucyA9IHtcbiAgICAgIC4uLnRoaXMuY3VycmVudE9wdGlvbnMsXG4gICAgICAuLi5vcHRpb25zLFxuICAgIH07XG4gIH1cblxuICBuZXh0TW9udGgoKTogdm9pZCB7XG4gICAgdGhpcy52aWV3aW5nRGF0ZSA9IGFkZE1vbnRocyh0aGlzLnZpZXdpbmdEYXRlLCAxKTtcbiAgICB0aGlzLmluaXQoKTtcbiAgfVxuXG4gIHByZXZNb250aCgpOiB2b2lkIHtcbiAgICB0aGlzLnZpZXdpbmdEYXRlID0gc3ViTW9udGhzKHRoaXMudmlld2luZ0RhdGUsIDEpO1xuICAgIHRoaXMuaW5pdCgpO1xuICB9XG5cbiAgc2V0RGF0ZShpOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBkYXRlID0gdGhpcy5kYXlzW2ldLmRhdGU7XG5cbiAgICBpZiAodGhpcy5jdXJyZW50T3B0aW9ucy5zZWxlY3RSYW5nZSkge1xuICAgICAgaWYgKCF0aGlzLnJhbmdlLnN0YXJ0ICYmICF0aGlzLnJhbmdlLmVuZCkge1xuICAgICAgICB0aGlzLnJhbmdlLnN0YXJ0ID0gZGF0ZTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5yYW5nZS5zdGFydCAmJiAhdGhpcy5yYW5nZS5lbmQgJiYgaXNBZnRlcihkYXRlLCB0aGlzLnJhbmdlLnN0YXJ0KSkge1xuICAgICAgICB0aGlzLnJhbmdlLmVuZCA9IGRhdGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnJhbmdlLmVuZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5yYW5nZS5zdGFydCA9IGRhdGU7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmFuZ2Uuc3RhcnQgPSB0aGlzLnJhbmdlLmVuZCA9IGRhdGU7XG4gICAgfVxuXG4gICAgdGhpcy5pbml0KCk7XG4gICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKHRoaXMuZ2V0VmFsdWVUb0VtaXQodGhpcy5yYW5nZSkpO1xuXG4gICAgaWYgKHRoaXMuY3VycmVudE9wdGlvbnMuY2xvc2VPblNlbGVjdGlvbiAmJiB0aGlzLnJhbmdlLmVuZCkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldFllYXIoaTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy52aWV3aW5nRGF0ZSA9IHNldFllYXIodGhpcy52aWV3aW5nRGF0ZSwgdGhpcy55ZWFyc1tpXS55ZWFyKTtcbiAgICB0aGlzLmluaXQoKTtcbiAgICB0aGlzLmluaXRZZWFycygpO1xuICAgIHRoaXMudmlldyA9ICdtb250aHMnO1xuICB9XG5cbiAgc2V0TW9udGgoaTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy52aWV3aW5nRGF0ZSA9IHNldE1vbnRoKHRoaXMudmlld2luZ0RhdGUsIHRoaXMubW9udGhzW2ldLm1vbnRoKTtcbiAgICB0aGlzLmluaXQoKTtcbiAgICB0aGlzLmluaXRNb250aHMoKTtcbiAgICB0aGlzLnZpZXcgPSAnZGF5cyc7XG4gIH1cblxuICBpbml0KCk6IHZvaWQge1xuICAgIGlmICghdGhpcy52aWV3aW5nRGF0ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0ID0gc3RhcnRPZk1vbnRoKHRoaXMudmlld2luZ0RhdGUpO1xuICAgIGNvbnN0IGVuZCA9IGVuZE9mTW9udGgodGhpcy52aWV3aW5nRGF0ZSk7XG5cbiAgICB0aGlzLmRheXMgPSBlYWNoRGF5T2ZJbnRlcnZhbCh7IHN0YXJ0LCBlbmQgfSkubWFwKChkYXRlKSA9PiB0aGlzLmZvcm1hdERheShkYXRlKSk7XG5cbiAgICBjb25zdCBmaXJzdE1vbnRoRGF5ID0gZ2V0RGF5KHN0YXJ0KSAtIHRoaXMuY3VycmVudE9wdGlvbnMuZmlyc3RDYWxlbmRhckRheTtcbiAgICBjb25zdCBwcmV2RGF5cyA9IGZpcnN0TW9udGhEYXkgPCAwID8gNyAtIHRoaXMuY3VycmVudE9wdGlvbnMuZmlyc3RDYWxlbmRhckRheSA6IGZpcnN0TW9udGhEYXk7XG4gICAgbGV0IG5leHREYXlzID0gKHRoaXMuY3VycmVudE9wdGlvbnMuZmlyc3RDYWxlbmRhckRheSA9PT0gMSA/IDcgOiA2KSAtIGdldERheShlbmQpO1xuXG4gICAgY29uc3Qgc2hvd1ByZXZNb250aERheXMgPSB0aGlzLmN1cnJlbnRPcHRpb25zLmluY2x1ZGVEYXlzID09PSAnYWxsJyB8fCB0aGlzLmN1cnJlbnRPcHRpb25zLmluY2x1ZGVEYXlzID09PSAncHJldmlvdXMtbW9udGgnO1xuICAgIGNvbnN0IHNob3dOZXh0TW9udGhEYXlzID0gdGhpcy5jdXJyZW50T3B0aW9ucy5pbmNsdWRlRGF5cyA9PT0gJ2FsbCcgfHwgdGhpcy5jdXJyZW50T3B0aW9ucy5pbmNsdWRlRGF5cyA9PT0gJ25leHQtbW9udGgnO1xuXG4gICAgaWYgKHNob3dOZXh0TW9udGhEYXlzICYmIHRoaXMuY3VycmVudE9wdGlvbnMuaW5jbHVkZU5leHRNb250aHNGaXJzdEZ1bGxXZWVrKSB7XG4gICAgICBuZXh0RGF5cyArPSA3O1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHByZXZEYXlzOyBpKyspIHtcbiAgICAgIHRoaXMuZGF5cy51bnNoaWZ0KHRoaXMuZm9ybWF0RGF5KHN1YkRheXMoc3RhcnQsIGkpLCBzaG93UHJldk1vbnRoRGF5cykpO1xuICAgIH1cblxuICAgIG5ldyBBcnJheShuZXh0RGF5cykuZmlsbCh1bmRlZmluZWQpXG4gICAgICAuZm9yRWFjaCgoXywgaSkgPT4gdGhpcy5kYXlzLnB1c2godGhpcy5mb3JtYXREYXkoYWRkRGF5cyhlbmQsIGkgKyAxKSwgc2hvd05leHRNb250aERheXMpKSk7XG5cblxuICAgIHRoaXMuZGlzcGxheVZhbHVlID0gdGhpcy5mb3JtYXREaXNwbGF5KCk7XG5cbiAgICBpZiAodGhpcy5yYW5nZSkge1xuICAgICAgdGhpcy5iYXJUaXRsZSA9IGZvcm1hdCh0aGlzLnZpZXdpbmdEYXRlLCB0aGlzLmN1cnJlbnRPcHRpb25zLmJhclRpdGxlRm9ybWF0LCB0aGlzLmN1cnJlbnRPcHRpb25zLmxvY2FsZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYmFyVGl0bGUgPSB0aGlzLmN1cnJlbnRPcHRpb25zLnVzZUVtcHR5QmFyVGl0bGUgP1xuICAgICAgICB0aGlzLmN1cnJlbnRPcHRpb25zLmJhclRpdGxlSWZFbXB0eSA6XG4gICAgICAgIGZvcm1hdCh0aGlzLnZpZXdpbmdEYXRlLCB0aGlzLmN1cnJlbnRPcHRpb25zLmJhclRpdGxlRm9ybWF0LCB0aGlzLmN1cnJlbnRPcHRpb25zLmxvY2FsZSk7XG4gICAgfVxuICB9XG5cbiAgaW5pdFllYXJzKCk6IHZvaWQge1xuICAgIGNvbnN0IHJhbmdlID0gdGhpcy5jdXJyZW50T3B0aW9ucy5tYXhZZWFyIC0gdGhpcy5jdXJyZW50T3B0aW9ucy5taW5ZZWFyO1xuXG4gICAgdGhpcy55ZWFycyA9IEFycmF5LmZyb20obmV3IEFycmF5KHJhbmdlKSwgKHgsIGkpID0+IGkgKyB0aGlzLmN1cnJlbnRPcHRpb25zLm1pblllYXIpLm1hcCgoeWVhcikgPT4ge1xuICAgICAgcmV0dXJuIHsgeWVhcjogeWVhciwgaXNUaGlzWWVhcjogeWVhciA9PT0gZ2V0WWVhcih0aGlzLnZpZXdpbmdEYXRlKSB9O1xuICAgIH0pO1xuICB9XG5cbiAgaW5pdE1vbnRocygpOiB2b2lkIHtcbiAgICB0aGlzLm1vbnRocyA9IEFycmF5LmZyb20obmV3IEFycmF5KDEyKSwgKHgsIGkpID0+IHNldE1vbnRoKG5ldyBEYXRlKCksIGkgKyAxKSlcbiAgICAgIC5tYXAoKGRhdGUpID0+IHtcbiAgICAgICAgcmV0dXJuIHsgbW9udGg6IGRhdGUuZ2V0TW9udGgoKSwgbmFtZTogZm9ybWF0KGRhdGUsICdNTU0nKSwgaXNTZWxlY3RlZDogZGF0ZS5nZXRNb250aCgpID09PSBnZXRNb250aCh0aGlzLnZpZXdpbmdEYXRlKSB9O1xuICAgICAgfSk7XG4gIH1cblxuICBpbml0RGF5TmFtZXMoKTogdm9pZCB7XG4gICAgdGhpcy5kYXlOYW1lcyA9IFtdO1xuICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5jdXJyZW50T3B0aW9ucy5maXJzdENhbGVuZGFyRGF5O1xuXG4gICAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDw9IDYgKyBzdGFydDsgaSsrKSB7XG4gICAgICBjb25zdCBkYXRlID0gc2V0RGF5KG5ldyBEYXRlKCksIGkpO1xuXG4gICAgICB0aGlzLmRheU5hbWVzLnB1c2goZm9ybWF0KGRhdGUsIHRoaXMuY3VycmVudE9wdGlvbnMuZGF5TmFtZXNGb3JtYXQsIHRoaXMuY3VycmVudE9wdGlvbnMubG9jYWxlKSk7XG4gICAgfVxuICB9XG5cbiAgdG9nZ2xlVmlldygpOiB2b2lkIHtcbiAgICB0aGlzLnZpZXcgPSB0aGlzLnZpZXcgPT09ICdkYXlzJyA/ICd5ZWFycycgOiAnZGF5cyc7XG4gIH1cblxuICB0b2dnbGUoKTogdm9pZCB7XG4gICAgdGhpcy5pc09wZW5lZCA9ICF0aGlzLmlzT3BlbmVkO1xuXG4gICAgaWYgKCF0aGlzLmlzT3BlbmVkICYmIHRoaXMudmlldyA9PT0gJ3llYXJzJykge1xuICAgICAgdGhpcy50b2dnbGVWaWV3KCk7XG4gICAgfVxuICB9XG5cbiAgY2xvc2UoKTogdm9pZCB7XG4gICAgdGhpcy5pc09wZW5lZCA9IGZhbHNlO1xuXG4gICAgaWYgKHRoaXMudmlldyA9PT0gJ3llYXJzJykge1xuICAgICAgdGhpcy50b2dnbGVWaWV3KCk7XG4gICAgfVxuICB9XG5cbiAgcmVzZXQoKTogdm9pZCB7XG4gICAgdGhpcy5yYW5nZSA9IHtcbiAgICAgIHN0YXJ0OiBuZXcgRGF0ZSgpLFxuICAgICAgZW5kOiBuZXcgRGF0ZSgpLFxuICAgIH07XG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICB3cml0ZVZhbHVlKHZhbDogRGF0ZVJhbmdlIHwgRGF0ZSB8IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgIGlmICh2YWwpIHtcbiAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgICAgICB0aGlzLnJhbmdlLnN0YXJ0ID0gdGhpcy5yYW5nZS5lbmQgPSBuZXcgRGF0ZSh2YWwpO1xuICAgICAgfSBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgIHRoaXMucmFuZ2Uuc3RhcnQgPSB0aGlzLnJhbmdlLmVuZCA9IHZhbDtcbiAgICAgIH0gZWxzZSBpZiAodmFsLnN0YXJ0KSB7IC8vIENoZWNraW5nIGlmIGl0J3MgaW5zdGFuY2Ugb2YgRGF0ZVJhbmdlXG4gICAgICAgIHRoaXMucmFuZ2UgPSB2YWw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBFcnJvcignSW52YWxpZCBpbnB1dCBkYXRhIHR5cGUnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy52aWV3aW5nRGF0ZSA9IHRoaXMucmFuZ2Uuc3RhcnQgfHwgdGhpcy52aWV3aW5nRGF0ZTtcblxuICAgICAgdGhpcy5pbml0KCk7XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXJPbkNoYW5nZShmbjogYW55KSB7XG4gICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrID0gZm47XG4gIH1cblxuICByZWdpc3Rlck9uVG91Y2hlZChmbjogYW55KSB7XG4gICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IGZuO1xuICB9XG5cbiAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6Y2xpY2snLCBbJyRldmVudCddKSBvbkJsdXIoZTogTW91c2VFdmVudCkge1xuICAgIGlmICghdGhpcy5pc09wZW5lZCB8fCAhdGhpcy5jdXJyZW50T3B0aW9ucy5jbG9zZU9uQ2xpY2tPdXRzaWRlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaW5wdXRFbGVtZW50ID09IG51bGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMuaW5wdXRFbGVtZW50Lm5hdGl2ZUVsZW1lbnQgfHxcbiAgICAgIHRoaXMuaW5wdXRFbGVtZW50Lm5hdGl2ZUVsZW1lbnQuY29udGFpbnMoPGFueT5lLnRhcmdldCkgfHxcbiAgICAgICgoPGFueT5lLnRhcmdldCkucGFyZW50RWxlbWVudCAmJiAoPGFueT5lLnRhcmdldCkucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2RheS11bml0JykpXG4gICAgKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2FsZW5kYXJDb250YWluZXJFbGVtZW50Lm5hdGl2ZUVsZW1lbnQgIT09IGUudGFyZ2V0ICYmXG4gICAgICAhdGhpcy5jYWxlbmRhckNvbnRhaW5lckVsZW1lbnQubmF0aXZlRWxlbWVudC5jb250YWlucyg8YW55PmUudGFyZ2V0KSAmJlxuICAgICAgISg8YW55PmUudGFyZ2V0KS5jbGFzc0xpc3QuY29udGFpbnMoJ3llYXItdW5pdCcpICYmXG4gICAgICAhKDxhbnk+ZS50YXJnZXQpLmNsYXNzTGlzdC5jb250YWlucygnbW9udGgtdW5pdCcpXG4gICAgKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cblxuICBmb3JtYXREYXkgPSAoZGF0ZTogRGF0ZSwgaXNWaXNpYmxlOiBib29sZWFuID0gdHJ1ZSk6IERheSA9PiAoXG4gICAge1xuICAgICAgZGF0ZTogZGF0ZSxcbiAgICAgIGRheTogZ2V0RGF0ZShkYXRlKSxcbiAgICAgIG1vbnRoOiBnZXRNb250aChkYXRlKSxcbiAgICAgIHllYXI6IGdldFllYXIoZGF0ZSksXG4gICAgICBpblRoaXNNb250aDogaXNTYW1lTW9udGgoZGF0ZSwgdGhpcy52aWV3aW5nRGF0ZSksXG4gICAgICBpc1RvZGF5OiBpc1Zpc2libGUgJiYgaXNUb2RheShkYXRlKSxcbiAgICAgIGlzU2VsZWN0ZWQ6IGlzVmlzaWJsZSAmJiB0aGlzLmlzRGF0ZVNlbGVjdGVkKGRhdGUpLFxuICAgICAgaXNJblJhbmdlOiBpc1Zpc2libGUgJiYgdGhpcy5pc0luUmFuZ2UoZGF0ZSksXG4gICAgICBpc1NlbGVjdGFibGU6IGlzVmlzaWJsZSAmJiB0aGlzLmlzRGF0ZVNlbGVjdGFibGUoZGF0ZSksXG4gICAgICBpc1N0YXJ0OiBpc1Zpc2libGUgJiYgdGhpcy5pc1JhbmdlQm91bmRhcnkoZGF0ZSwgJ3N0YXJ0JyksXG4gICAgICBpc0VuZDogaXNWaXNpYmxlICYmIHRoaXMuaXNSYW5nZUJvdW5kYXJ5KGRhdGUsICdlbmQnKSxcbiAgICAgIGlzVmlzaWJsZSxcbiAgICB9XG4gIClcblxuICBnZXREYXlDbGFzc2VzKGRheTogRGF5KTogQWRkQ2xhc3Mge1xuICAgIHJldHVybiB7XG4gICAgICAnaXMtcHJldi1tb250aCc6ICFkYXkuaW5UaGlzTW9udGgsXG4gICAgICAnaXMtdG9kYXknOiBkYXkuaXNUb2RheSxcbiAgICAgICdpcy1zZWxlY3RlZCc6IGRheS5pc1NlbGVjdGVkLFxuICAgICAgJ2lzLWluLXJhbmdlJzogZGF5LmlzSW5SYW5nZSxcbiAgICAgICdpcy1kaXNhYmxlZCc6ICFkYXkuaXNTZWxlY3RhYmxlLFxuICAgICAgJ3JhbmdlLXN0YXJ0JzogZGF5LmlzU3RhcnQsXG4gICAgICAncmFuZ2UtZW5kJzogZGF5LmlzRW5kLFxuICAgICAgJ2lzLXZpc2libGUnOiBkYXkuaXNWaXNpYmxlLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIHNwZWNpZmllZCBkYXRlIGlzIGluIHJhbmdlIG9mIG1pbiBhbmQgbWF4IGRhdGVzXG4gICAqIEBwYXJhbSBkYXRlXG4gICAqL1xuICBwcml2YXRlIGlzRGF0ZVNlbGVjdGFibGUoZGF0ZTogRGF0ZSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IG1pbkRhdGVTZXQgPSAhaXNOaWwodGhpcy5jdXJyZW50T3B0aW9ucy5taW5EYXRlKTtcbiAgICBjb25zdCBtYXhEYXRlU2V0ID0gIWlzTmlsKHRoaXMuY3VycmVudE9wdGlvbnMubWF4RGF0ZSk7XG4gICAgY29uc3QgdGltZXN0YW1wID0gZGF0ZS52YWx1ZU9mKCk7XG5cbiAgICByZXR1cm4gKCEobWluRGF0ZVNldCAmJiB0aW1lc3RhbXAgPCB0aGlzLmN1cnJlbnRPcHRpb25zLm1pbkRhdGUudmFsdWVPZigpKSB8fFxuICAgICAgKCEobWF4RGF0ZVNldCAmJiB0aW1lc3RhbXAgPiB0aGlzLmN1cnJlbnRPcHRpb25zLm1heERhdGUudmFsdWVPZigpKSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBpc0RhdGVTZWxlY3RlZChkYXRlOiBEYXRlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGlzU2FtZURhdGUoZGF0ZSwgdGhpcy5yYW5nZS5zdGFydCkgfHwgaXNTYW1lRGF0ZShkYXRlLCB0aGlzLnJhbmdlLmVuZCk7XG4gIH1cblxuICBwcml2YXRlIGlzSW5SYW5nZShkYXRlOiBEYXRlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaXNEYXRlU2VsZWN0ZWQoZGF0ZSkgfHwgKGlzQWZ0ZXIoZGF0ZSwgdGhpcy5yYW5nZS5zdGFydCkgJiYgaXNCZWZvcmUoZGF0ZSwgdGhpcy5yYW5nZS5lbmQpKTtcbiAgfVxuXG4gIHByaXZhdGUgZm9ybWF0RGlzcGxheSgpOiBzdHJpbmcge1xuICAgIGlmICghdGhpcy5yYW5nZSkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIGNvbnN0IGZvcm1hdHRlZFN0YXJ0RGF0ZSA9IGZvcm1hdCh0aGlzLnJhbmdlLnN0YXJ0LCB0aGlzLmN1cnJlbnRPcHRpb25zLmRpc3BsYXlGb3JtYXQsIHRoaXMuY3VycmVudE9wdGlvbnMubG9jYWxlKTtcblxuICAgIGlmICh0aGlzLmN1cnJlbnRPcHRpb25zLnNlbGVjdFJhbmdlKSB7XG4gICAgICBjb25zdCBmb3JtYXR0ZWRFbmREYXRlID0gZm9ybWF0KFxuICAgICAgICB0aGlzLnJhbmdlLmVuZCB8fCB0aGlzLnJhbmdlLnN0YXJ0LFxuICAgICAgICB0aGlzLmN1cnJlbnRPcHRpb25zLmRpc3BsYXlGb3JtYXQsXG4gICAgICAgIHRoaXMuY3VycmVudE9wdGlvbnMubG9jYWxlXG4gICAgICApO1xuXG4gICAgICByZXR1cm4gYCR7Zm9ybWF0dGVkU3RhcnREYXRlfSR7dGhpcy5jdXJyZW50T3B0aW9ucy5yYW5nZVNlcGFyYXRvcn0ke2Zvcm1hdHRlZEVuZERhdGV9YDtcbiAgICB9XG5cbiAgICByZXR1cm4gZm9ybWF0dGVkU3RhcnREYXRlO1xuICB9XG5cbiAgcHJpdmF0ZSBpc1JhbmdlQm91bmRhcnkoZGF0ZTogRGF0ZSwgYm91bmRhcnk6ICdzdGFydCcgfCAnZW5kJyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhdGhpcy5yYW5nZVtib3VuZGFyeV0gfHwgaXNTYW1lRGF0ZShkYXRlLCB0aGlzLnJhbmdlW2JvdW5kYXJ5XSk7XG4gIH1cblxuICBwcml2YXRlIGdldFZhbHVlVG9FbWl0KHJhbmdlOiBEYXRlUmFuZ2UpOiBEYXRlUmFuZ2UgfCBEYXRlIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudE9wdGlvbnMuc2VsZWN0UmFuZ2UpIHtcbiAgICAgIHJldHVybiBuZXcgRGF0ZShyYW5nZS5zdGFydC5nZXRUaW1lKCkpO1xuICAgIH1cblxuICAgIGlmIChyYW5nZS5lbmQpIHtcbiAgICAgIHJldHVybiBjcmVhdGVEYXRlUmFuZ2UocmFuZ2Uuc3RhcnQsIHJhbmdlLmVuZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNyZWF0ZURhdGVSYW5nZShyYW5nZS5zdGFydCwgcmFuZ2Uuc3RhcnQpO1xuICB9XG59XG4iXX0=